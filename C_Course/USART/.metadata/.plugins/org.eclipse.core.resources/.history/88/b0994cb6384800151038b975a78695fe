#include "tick.h"

// ----------------------------------------------------------------------------

static volatile uint32_t TickCounter;

void tick_init(void)
{
  // Use SysTick as reference for the delay loops.
  SysTick_Config (SystemCoreClock / TIMER_FREQUENCY_HZ);
}

uint32_t timer_GetTick(void)
{
    return TickCounter;
}
void timer_DelayMs (uint32_t ticks)
{
  timer_delayCount = ticks;

  // Busy wait until the SysTick decrements the counter to zero.
  while (timer_delayCount != 0u)
    ;
}

void timer_tick (void)
{
  // Decrement to zero the counter used by the delay routine.
  if (timer_delayCount != 0u)
    {
      --timer_delayCount;
    }
}

// ----- SysTick_Handler() ----------------------------------------------------

void SysTick_Handler (void)
{
    TickCounter++;
}

// ----------------------------------------------------------------------------
